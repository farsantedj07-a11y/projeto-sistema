
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CP3 - Scanner IA Real</title>

<style>
body{
  font-family: monospace;
  background:#000;
  color:#00ff88;
  margin:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
}

.scanner{
  position:relative;
  width:80%;
  max-width:600px;
  height:320px;
  border:2px solid #00ff88;
  border-radius:10px;
  overflow:hidden;
  background:#020202;
}

video{
  width:100%;
  height:100%;
  object-fit:cover;
  opacity:0.35;
}

.laser{
  position:absolute;
  width:100%;
  height:2px;
  background:#00ff88;
  box-shadow:0 0 10px #00ff88;
  animation:scan 2.5s linear infinite;
}

@keyframes scan{
  from{top:0}
  to{top:100%}
}

.status{
  margin-top:20px;
  text-align:center;
}

.btn-voltar{
  margin-top:20px;
  color:#00ff88;
  text-decoration:none;
  border:1px solid #00ff88;
  padding:8px 16px;
  border-radius:6px;
}
</style>
</head>

<body>

<div class="scanner">
  <!-- vídeo vindo do CP2 -->
  <video id="videoRef" autoplay muted></video>
  <div class="laser"></div>
</div>

<div class="status">
  <div>STATUS: <span id="statusTxt">AGUARDANDO VÍDEO DO CP2...</span></div>
</div>

<a href="../index.html" class="btn-voltar">VOLTAR AO PAINEL</a>

<script>
const video = document.getElementById("videoRef");
const statusTxt = document.getElementById("statusTxt");

/*
EXTENSOR:
escuta o CP2 via armazenamento compartilhado do navegador
*/
window.addEventListener("storage", (e)=>{
  if(e.key === "cp2_video"){
    video.src = e.newValue;
    statusTxt.textContent = "VÍDEO RECEBIDO • ANALISANDO EM TEMPO REAL";
  }
});

/*
se já existir vídeo salvo
*/
const saved = localStorage.getItem("cp2_video");
if(saved){
  video.src = saved;
  statusTxt.textContent = "VÍDEO CONECTADO • SCANNER ATIVO";
}
</script>

</body>
</html>
